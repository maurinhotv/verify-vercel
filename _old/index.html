<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Home - Seu Servidor</title>

  <style>
    :root{
      --bg:#070a07;
      --card: rgba(0,0,0,.55);
      --stroke: rgba(255,255,255,.10);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.72);
      --green: #b7ff1a;
      --green2:#a7ff00;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius: 14px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--font);
      color:var(--text);
      background: var(--bg);
      overflow-x:hidden;
    }

    /* ===== MOTION BASE ===== */
    .reveal{ opacity:0; transform: translateY(14px); filter: blur(6px); }
    .reveal.show{ opacity:1; transform: translateY(0); filter: blur(0); transition: .7s cubic-bezier(.2,.9,.2,1); }
    .floaty{ animation: floaty 6s ease-in-out infinite; }
    @keyframes floaty{ 0%,100%{ transform: translateY(0)} 50%{ transform: translateY(-8px)} }

    .shine{
      position:relative;
      overflow:hidden;
      isolation:isolate;
    }
    .shine:before{
      content:"";
      position:absolute; inset:-120px;
      background: radial-gradient(circle at var(--mx,50%) var(--my,30%), rgba(255,255,255,.22), transparent 55%);
      opacity:.0;
      transition: opacity .2s ease;
      pointer-events:none;
      z-index:0;
    }
    .shine:hover:before{ opacity:.9; }

    /* ===== HERO ===== */
    .hero{
      min-height:100vh;
      position:relative;
      display:flex;
      flex-direction:column;
    }

    .hero__bg{
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 600px at 75% 35%, rgba(183,255,26,.22), transparent 65%),
        radial-gradient(900px 500px at 20% 70%, rgba(0,0,0,.55), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.65)),
        url("https://images.unsplash.com/photo-1496307653780-42ee777d4833?auto=format&fit=crop&w=2400&q=80");
      background-size: cover;
      background-position:center;
      filter:saturate(1.1) contrast(1.05);
      transform: scale(1.03);
      transition: transform .35s ease;
      will-change: transform;
    }

    .hero__overlay{
      position:absolute; inset:0;
      background:
        radial-gradient(1200px 700px at 50% 60%, rgba(0,0,0,.35), rgba(0,0,0,.78)),
        linear-gradient(90deg, rgba(0,0,0,.35), rgba(0,0,0,.10), rgba(0,0,0,.35));
      pointer-events:none;
    }

    /* Hex lines */
    .hero__hex{
      position:absolute; inset:-140px;
      opacity:.25;
      pointer-events:none;
      background-image:
        linear-gradient(120deg, rgba(255,255,255,.18) 2px, transparent 2px),
        linear-gradient(60deg, rgba(255,255,255,.12) 2px, transparent 2px);
      background-size: 380px 380px;
      transform: rotate(-8deg);
      mix-blend-mode: overlay;
      mask-image: radial-gradient(circle at 55% 40%, rgba(0,0,0,1), rgba(0,0,0,.1) 62%, rgba(0,0,0,0) 78%);
      animation: hexDrift 18s linear infinite;
    }
    @keyframes hexDrift{
      0%{ background-position: 0 0, 0 0; }
      100%{ background-position: 380px 380px, -380px -380px; }
    }

    /* ===== NAVBAR ===== */
    .nav{
      position:relative;
      z-index:5;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 22px 54px;
      gap:18px;
    }

    .navGlass{
      position:absolute;
      inset: 10px 44px auto 44px;
      height: 62px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.28));
      border: 1px solid rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 55px rgba(0,0,0,.35);
      z-index: -1;
      opacity: .92;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      user-select:none;
    }
    .brand__mark{
      width:34px;height:34px;
      background: linear-gradient(135deg, var(--green), #7cff00);
      border-radius: 10px;
      box-shadow: 0 10px 28px rgba(183,255,26,.25);
      position:relative;
      overflow:hidden;
    }
    .brand__mark:before{
      content:"";
      position:absolute; inset:-18px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%);
      transform: rotate(18deg);
    }
    .brand__name{
      font-weight:900;
      letter-spacing:.3px;
      font-size: 20px;
      text-transform: lowercase;
    }

    .navlinks{
      display:flex;
      align-items:center;
      gap:22px;
      font-weight:700;
      font-size: 14px;
      color: rgba(255,255,255,.80);
    }
    .navlinks a{
      color:inherit;
      text-decoration:none;
      padding:10px 10px;
      border-radius: 12px;
      transition:.15s ease;
      position:relative;
      overflow:hidden;
    }
    .navlinks a:after{
      content:"";
      position:absolute; left:12px; right:12px; bottom:8px;
      height:2px;
      background: linear-gradient(90deg, transparent, rgba(183,255,26,.95), transparent);
      transform: scaleX(0);
      transform-origin:center;
      transition: transform .18s ease;
      opacity:.85;
    }
    .navlinks a:hover{
      color:#fff;
      background: rgba(255,255,255,.06);
    }
    .navlinks a:hover:after{ transform: scaleX(1); }

    .navright{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 260px;
      justify-content:flex-end;
    }

    .btn{
      border:0;
      cursor:pointer;
      border-radius: 12px;
      padding: 10px 16px;
      font-weight:1000;
      letter-spacing:.2px;
      transition:.15s ease;
      color:#0b0f06;
      background: var(--green);
      box-shadow: 0 14px 34px rgba(183,255,26,.18);
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
    }
    .btn:before{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent);
      transform: translateX(-120%);
      transition: transform .55s ease;
      opacity:.9;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.03); }
    .btn:hover:before{ transform: translateX(120%); }
    .btn:active{ transform: translateY(0px); }
    .btn[disabled]{ opacity:.6; cursor:not-allowed; transform:none !important; filter:none !important; }

    .btn--ghost{
      background: rgba(0,0,0,.30);
      color: rgba(255,255,255,.92);
      border: 1px solid rgba(255,255,255,.14);
      box-shadow:none;
    }
    .btn--ghost:hover{ background: rgba(0,0,0,.42); }

    /* Barra logado */
    .userbar{
      display:none;
      align-items:center;
      gap:12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(183,255,26,.22);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    .userbar__panel{
      display:flex;
      align-items:center;
      gap:10px;
      border-radius: 12px;
      padding: 8px 12px;
      border: 1px solid rgba(183,255,26,.35);
      background: rgba(0,0,0,.35);
      color: rgba(183,255,26,.95);
      font-weight:1000;
      font-size:12px;
      text-transform: uppercase;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      transition: .15s ease;
    }
    .userbar__panel:hover{ transform: translateY(-1px); filter: brightness(1.05); }

    .userbar__user{
      display:flex;
      align-items:center;
      gap:8px;
      color: rgba(255,255,255,.9);
      font-weight:900;
      font-size: 13px;
      white-space:nowrap;
    }
    .avatar{
      width:22px; height:22px;
      border-radius: 8px;
      background: linear-gradient(135deg, rgba(255,255,255,.22), rgba(255,255,255,.06));
      border: 1px solid rgba(255,255,255,.18);
    }
    .userid{
      color: rgba(255,255,255,.65);
      font-weight:800;
      font-size: 12px;
    }

    /* ===== CENTER ===== */
    .content{
      position:relative;
      z-index:4;
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 0 24px 80px;
      text-align:center;
    }

    .center{
      max-width: 900px;
      width:100%;
      margin-top: 26px;
    }

    .logoBig{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:18px;
      margin-bottom: 8px;
    }
    .logoBig__mark{
      width:86px;height:86px;
      border-radius: 22px;
      background: linear-gradient(135deg, var(--green), #7cff00);
      box-shadow: 0 18px 60px rgba(183,255,26,.25);
      position:relative;
      overflow:hidden;
    }
    .logoBig__mark:before{
      content:"";
      position:absolute; inset:-30px;
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.35), transparent 60%);
      transform: rotate(18deg);
    }
    .logoBig__title{
      font-size: 86px;
      font-weight: 1000;
      letter-spacing:-1.5px;
      line-height:1;
      text-transform: lowercase;
      text-shadow: 0 18px 55px rgba(0,0,0,.55);
    }

    .subtitle{
      margin-top: 10px;
      font-size: 28px;
      color: rgba(255,255,255,.85);
      font-weight:800;
      text-shadow: 0 12px 40px rgba(0,0,0,.55);
    }

    .playWrap{
      margin-top: 26px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:12px;
    }

    .playBtn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 14px 22px;
      border-radius: 14px;
      border: 0;
      cursor:pointer;
      background: var(--green);
      color:#0b0f06;
      font-weight: 1000;
      letter-spacing: .6px;
      box-shadow: 0 18px 55px rgba(183,255,26,.22);
      text-transform: uppercase;
      font-size: 18px;
      transition: .15s ease;
      position:relative;
      overflow:hidden;
    }
    .playBtn:before{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.24), transparent);
      transform: translateX(-120%);
      transition: transform .65s ease;
      opacity:.9;
    }
    .playBtn:hover{ transform: translateY(-1px); filter: brightness(1.02); }
    .playBtn:hover:before{ transform: translateX(120%); }
    .playBtn:active{ transform: translateY(0); }
    .playBtn .arrow{ opacity:.9; font-weight: 1000; }

    .icons{
      margin-top: 18px;
      display:flex;
      justify-content:center;
      gap:14px;
      opacity:.92;
    }
    .icons a{
      width:36px; height:36px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(0,0,0,.32);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.92);
      text-decoration:none;
      transition:.15s ease;
      backdrop-filter: blur(8px);
    }
    .icons a:hover{ background: rgba(0,0,0,.5); transform: translateY(-2px); }

    /* ===== TOAST ===== */
    .toast{
      position: fixed;
      right: 18px;
      bottom: 18px;
      z-index: 80;
      display:flex;
      flex-direction:column;
      gap:10px;
      pointer-events:none;
    }
    .toast__item{
      pointer-events:auto;
      min-width: 260px;
      max-width: 360px;
      padding: 12px 14px;
      border-radius: 14px;
      background: rgba(0,0,0,.62);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 18px 55px rgba(0,0,0,.45);
      backdrop-filter: blur(10px);
      animation: toastIn .25s ease forwards;
    }
    .toast__item.ok{ border-color: rgba(183,255,26,.28); }
    .toast__item.err{ border-color: rgba(255,107,107,.28); }
    .toast__title{ font-weight:1000; font-size: 13px; margin-bottom: 2px; }
    .toast__text{ font-weight:700; font-size: 13px; color: rgba(255,255,255,.78); line-height: 1.35; }
    @keyframes toastIn{ from{ opacity:0; transform: translateY(10px);} to{ opacity:1; transform: translateY(0);} }

    /* ===== MODAL ===== */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
      padding: 20px;
    }
    .modal.open{ display:flex; }
    .modal__backdrop{
      position:absolute; inset:0;
      background: rgba(0,0,0,.65);
      backdrop-filter: blur(6px);
      animation: fadeIn .18s ease forwards;
    }
    @keyframes fadeIn{ from{opacity:0} to{opacity:1} }

    .modal__card{
      position:relative;
      width: 100%;
      max-width: 420px;
      border-radius: 18px;
      background: rgba(10,12,10,.92);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      overflow:hidden;
      transform: translateY(10px) scale(.985);
      opacity:0;
      animation: popIn .22s cubic-bezier(.2,.9,.2,1) forwards;
      backdrop-filter: blur(10px);
    }
    @keyframes popIn{
      to{ transform: translateY(0) scale(1); opacity:1; }
    }

    .modal__top{
      padding: 16px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .modal__title{ font-weight: 1000; letter-spacing:.2px; }
    .x{
      width:34px;height:34px;
      display:grid; place-items:center;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      cursor:pointer;
      color: rgba(255,255,255,.85);
    }
    .x:hover{ background: rgba(255,255,255,.08); }

    .modal__body{ padding: 18px; }
    .field{ display:flex; flex-direction:column; gap:8px; margin-bottom: 12px; }
    .label{ color: rgba(255,255,255,.8); font-weight:900; font-size: 12px; text-transform: uppercase; letter-spacing:.4px; }
    .input{
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.35);
      color: rgba(255,255,255,.92);
      outline:none;
      transition: .15s ease;
    }
    .input:focus{
      border-color: rgba(183,255,26,.35);
      box-shadow: 0 0 0 4px rgba(183,255,26,.10);
    }
    .help{ font-size: 12px; color: rgba(255,255,255,.62); margin-top: -2px; margin-bottom: 10px; }

    .row{ display:flex; gap:10px; margin-top: 14px; }
    .row .btn{ flex:1; border-radius: 12px; padding: 12px 14px; }
    .msg{ margin-top: 12px; font-size: 13px; font-weight:800; color: rgba(255,255,255,.82); min-height: 18px; }
    .msg.ok{ color: rgba(183,255,26,.95); }
    .msg.err{ color: #ff6b6b; }

    /* ===== RESPONSIVO ===== */
    @media (max-width: 980px){
      .nav{ padding: 18px 16px; }
      .navGlass{ inset: 8px 10px auto 10px; }
      .navlinks{ display:none; }
      .logoBig__title{ font-size: 56px; }
      .logoBig__mark{ width:68px; height:68px; border-radius: 18px; }
      .subtitle{ font-size: 20px; }
      .navright{ min-width:unset; }
    }
  </style>
</head>

<body>
  <section class="hero">
    <div class="hero__bg" id="heroBg"></div>
    <div class="hero__overlay"></div>
    <div class="hero__hex"></div>

    <header class="nav reveal">
      <div class="navGlass"></div>

      <div class="brand">
        <div class="brand__mark floaty" aria-hidden="true"></div>
        <div class="brand__name" id="brandName">metr√≥pole</div>
      </div>

      <nav class="navlinks">
        <a href="#" data-link="cidades">Nossas Cidades</a>
        <a href="#" data-link="noticias">Not√≠cias</a>
        <a href="#" data-link="diamantes">Diamantes</a>
        <a href="#" data-link="anticheat">Anticheat</a>
      </nav>

      <div class="navright">
        <!-- DESLOGADO -->
        <button class="btn btn--ghost shine" id="btnRegister">CRIAR CONTA</button>
        <button class="btn shine" id="btnLogin">ENTRAR</button>

        <!-- LOGADO -->
        <div class="userbar reveal" id="userbar">
          <div class="userbar__panel shine" id="btnPanel">
            ACESSAR PAINEL <span style="opacity:.9">‚Ä∫</span>
          </div>
          <div class="userbar__user">
            <span class="avatar" aria-hidden="true"></span>
            <span id="usernameTop">usuario</span>
            <span class="userid" id="useridTop">#0</span>
          </div>
          <button class="btn btn--ghost shine" id="btnLogout" style="padding:10px 12px;">SAIR</button>
        </div>
      </div>
    </header>

    <main class="content">
      <div class="center">
        <div class="logoBig reveal">
          <div class="logoBig__mark floaty" aria-hidden="true"></div>
          <div class="logoBig__title" id="heroTitle">metr√≥pole</div>
        </div>

        <div class="subtitle reveal" id="heroSubtitle">Sua vida nova come√ßa aqui.</div>

        <div class="playWrap reveal">
          <button class="playBtn shine" id="btnPlay">
            üéÆ JOGAR AGORA <span class="arrow">‚Ä∫</span>
          </button>
        </div>

        <div class="icons reveal">
          <a href="#" title="Instagram" aria-label="Instagram">‚åÅ</a>
          <a href="#" title="YouTube" aria-label="YouTube">‚ñ∂</a>
          <a href="#" title="X" aria-label="X">ùïè</a>
          <a href="#" title="Discord" aria-label="Discord">‚ò∞</a>
        </div>
      </div>
    </main>
  </section>

  <!-- TOAST -->
  <div class="toast" id="toast"></div>

  <!-- MODAL LOGIN -->
  <div class="modal" id="modalLogin" aria-hidden="true">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card">
      <div class="modal__top">
        <div class="modal__title">Entrar</div>
        <button class="x" data-close="1">‚úï</button>
      </div>
      <div class="modal__body">
        <div class="field">
          <div class="label">Usu√°rio</div>
          <input class="input" id="loginUser" autocomplete="username" placeholder="Seu usu√°rio" />
        </div>
        <div class="field">
          <div class="label">Senha</div>
          <input class="input" id="loginPass" type="password" autocomplete="current-password" placeholder="Sua senha" />
        </div>

        <div class="row">
          <button class="btn btn--ghost shine" id="loginToRegister">Criar conta</button>
          <button class="btn shine" id="doLogin">Entrar</button>
        </div>

        <div class="msg" id="loginMsg"></div>
      </div>
    </div>
  </div>

  <!-- MODAL REGISTER -->
  <div class="modal" id="modalRegister" aria-hidden="true">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card">
      <div class="modal__top">
        <div class="modal__title">Criar conta</div>
        <button class="x" data-close="1">‚úï</button>
      </div>
      <div class="modal__body">
        <div class="field">
          <div class="label">Usu√°rio</div>
          <input class="input" id="regUser" autocomplete="username" placeholder="Escolha um usu√°rio" />
          <div class="help">M√≠nimo 3 caracteres.</div>
        </div>

        <div class="field">
          <div class="label">Senha</div>
          <input class="input" id="regPass" type="password" autocomplete="new-password" placeholder="Crie uma senha" />
          <div class="help">M√≠nimo 6 caracteres.</div>
        </div>

        <div class="row">
          <button class="btn btn--ghost shine" id="registerToLogin">J√° tenho conta</button>
          <button class="btn shine" id="doRegister">Criar</button>
        </div>

        <div class="msg" id="regMsg"></div>
      </div>
    </div>
  </div>

  <script>
    // ===== CONFIG =====
    const CONFIG = {
      serverName: "metr√≥pole",
      playUrl: "mtasa://SEU_IP:SEU_PORTA",
      panelUrl: "/painel.html",
      LS_KEY: "site_session_v1"
    };

    // ===== SESSION =====
    function getSession(){
      try{ return JSON.parse(localStorage.getItem(CONFIG.LS_KEY) || "null"); }catch{ return null; }
    }
    function setSession(s){
      localStorage.setItem(CONFIG.LS_KEY, JSON.stringify(s));
      applyAuthUI();
    }
    function clearSession(){
      localStorage.removeItem(CONFIG.LS_KEY);
      applyAuthUI();
    }

    function applyAuthUI(){
      const s = getSession();

      const btnLogin = document.getElementById("btnLogin");
      const btnRegister = document.getElementById("btnRegister");
      const userbar = document.getElementById("userbar");

      if(s && s.ok){
        btnLogin.style.display = "none";
        btnRegister.style.display = "none";
        userbar.style.display = "flex";

        document.getElementById("usernameTop").textContent = s.username || "usuario";
        document.getElementById("useridTop").textContent = "#" + (s.user_id ?? "0");
      } else {
        btnLogin.style.display = "inline-flex";
        btnRegister.style.display = "inline-flex";
        userbar.style.display = "none";
      }
    }

    // ===== TOAST =====
    const toastEl = document.getElementById("toast");
    function toast(title, text, type){
      const item = document.createElement("div");
      item.className = "toast__item " + (type || "");
      item.innerHTML = `<div class="toast__title">${title}</div><div class="toast__text">${text}</div>`;
      toastEl.appendChild(item);
      setTimeout(()=>{ item.style.opacity = "0"; item.style.transform = "translateY(8px)"; }, 2600);
      setTimeout(()=>{ item.remove(); }, 3050);
    }

    // ===== MODALS =====
    function openModal(el){
      el.classList.add("open");
      el.setAttribute("aria-hidden","false");
    }
    function closeModal(el){
      el.classList.remove("open");
      el.setAttribute("aria-hidden","true");
    }
    function setMsg(el, text, type){
      el.textContent = text || "";
      el.className = "msg" + (type ? " " + type : "");
    }

    async function postJSON(url, payload){
      const r = await fetch(url, {
        method:"POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify(payload || {})
      });
      const data = await r.json().catch(()=> ({}));
      return { ok: r.ok, status: r.status, data };
    }

    // ===== SHINE MOUSE =====
    function bindShine(el){
      el.addEventListener("mousemove", (e)=>{
        const r = el.getBoundingClientRect();
        const mx = ((e.clientX - r.left) / r.width) * 100;
        const my = ((e.clientY - r.top) / r.height) * 100;
        el.style.setProperty("--mx", mx + "%");
        el.style.setProperty("--my", my + "%");
      });
    }
    document.querySelectorAll(".shine").forEach(bindShine);

    // ===== REVEAL =====
    const obs = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting) e.target.classList.add("show");
      });
    }, { threshold: .12 });
    document.querySelectorAll(".reveal").forEach(el=>obs.observe(el));

    // ===== PARALLAX BG (leve) =====
    const heroBg = document.getElementById("heroBg");
    window.addEventListener("mousemove", (e)=>{
      const x = (e.clientX / window.innerWidth - 0.5) * 8;
      const y = (e.clientY / window.innerHeight - 0.5) * 6;
      heroBg.style.transform = `scale(1.04) translate(${x}px, ${y}px)`;
    });

    // ===== Wire =====
    document.getElementById("brandName").textContent = CONFIG.serverName;
    document.getElementById("heroTitle").textContent = CONFIG.serverName;

    // Play
    document.getElementById("btnPlay").addEventListener("click", () => {
      window.location.href = CONFIG.playUrl;
    });

    // Panel
    document.getElementById("btnPanel").addEventListener("click", () => {
      window.location.href = CONFIG.panelUrl;
    });

    // Logout
    document.getElementById("btnLogout").addEventListener("click", () => {
      clearSession();
      toast("Sess√£o", "Voc√™ saiu da sua conta.", "ok");
    });

    // Open modals
    const modalLogin = document.getElementById("modalLogin");
    const modalRegister = document.getElementById("modalRegister");

    document.getElementById("btnLogin").addEventListener("click", () => openModal(modalLogin));
    document.getElementById("btnRegister").addEventListener("click", () => openModal(modalRegister));

    // Close modals
    document.querySelectorAll("[data-close]").forEach(el => {
      el.addEventListener("click", () => {
        closeModal(modalLogin);
        closeModal(modalRegister);
      });
    });
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        closeModal(modalLogin);
        closeModal(modalRegister);
      }
    });

    // Switch
    document.getElementById("loginToRegister").addEventListener("click", () => {
      closeModal(modalLogin);
      openModal(modalRegister);
    });
    document.getElementById("registerToLogin").addEventListener("click", () => {
      closeModal(modalRegister);
      openModal(modalLogin);
    });

    // Register
    document.getElementById("doRegister").addEventListener("click", async () => {
      const u = document.getElementById("regUser").value.trim();
      const p = document.getElementById("regPass").value;
      const msg = document.getElementById("regMsg");
      const btn = document.getElementById("doRegister");

      if(u.length < 3) return setMsg(msg, "Usu√°rio muito curto (m√≠n. 3).", "err");
      if(p.length < 6) return setMsg(msg, "Senha muito curta (m√≠n. 6).", "err");

      btn.disabled = true;
      btn.textContent = "CRIANDO...";
      setMsg(msg, "Criando conta...", "");

      const res = await postJSON("/api/registerUser", { username: u, password: p });

      btn.disabled = false;
      btn.textContent = "Criar";

      if(res.ok && res.data.ok){
        setMsg(msg, "Conta criada! Agora fa√ßa login.", "ok");
        toast("Conta", "Conta criada com sucesso.", "ok");
        setTimeout(() => {
          closeModal(modalRegister);
          openModal(modalLogin);
          document.getElementById("loginUser").value = u;
          document.getElementById("loginPass").value = "";
          setMsg(document.getElementById("loginMsg"), "", "");
        }, 650);
      } else {
        setMsg(msg, res.data.msg || "Erro ao criar conta.", "err");
        toast("Erro", res.data.msg || "N√£o foi poss√≠vel criar.", "err");
      }
    });

    // Login
    document.getElementById("doLogin").addEventListener("click", async () => {
      const u = document.getElementById("loginUser").value.trim();
      const p = document.getElementById("loginPass").value;
      const msg = document.getElementById("loginMsg");
      const btn = document.getElementById("doLogin");

      if(!u || !p) return setMsg(msg, "Preencha usu√°rio e senha.", "err");

      btn.disabled = true;
      btn.textContent = "ENTRANDO...";
      setMsg(msg, "Entrando...", "");

      const res = await postJSON("/api/login", { username: u, password: p });

      btn.disabled = false;
      btn.textContent = "Entrar";

      if(res.ok && res.data.ok){
        setSession({
          ok: true,
          username: res.data.username || u,
          user_id: res.data.user_id,
          vip: res.data.vip || "none"
        });

        setMsg(msg, "Logado! ‚úÖ", "ok");
        toast("Bem-vindo", "Login efetuado com sucesso.", "ok");
        setTimeout(() => closeModal(modalLogin), 450);
      } else {
        setMsg(msg, "Usu√°rio ou senha inv√°lidos.", "err");
        toast("Login", "Usu√°rio ou senha inv√°lidos.", "err");
      }
    });

    // Enter key
    ["loginUser","loginPass"].forEach(id=>{
      document.getElementById(id).addEventListener("keydown", (e)=>{
        if(e.key === "Enter") document.getElementById("doLogin").click();
      });
    });
    ["regUser","regPass"].forEach(id=>{
      document.getElementById(id).addEventListener("keydown", (e)=>{
        if(e.key === "Enter") document.getElementById("doRegister").click();
      });
    });

    // Abrir login se veio do painel
    if(localStorage.getItem("open_login_modal") === "1"){
      localStorage.removeItem("open_login_modal");
      openModal(modalLogin);
    }

    // Init
    applyAuthUI();
  </script>
</body>
</html>
